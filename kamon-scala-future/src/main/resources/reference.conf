# ========================================== #
# kamon-scala-future Reference Configuration #
# ========================================== #

kamon.instrumentation.futures.scala {

  # Settings controlling the behavior of the Delayed Spans created by the Scala Future instrumentation
  trace {

    # Controls metrics tracking on all Spans generated by the Scala Future Instrumentation. When enabled, the default
    # metrics for Delayed Spans will be tracked:
    #
    #   - span.elapsed-time: measures the time since a future or callback was created until it finished executing.
    #   - span.wait-time:
    #   - span.processing-time: n
    track-span-metrics = yes

    # Controls tracking of Delayed Span-specific metrics on all Spans generated by the Scala Future Instrumentation.
    track-delayed-span-metrics = yes
  }
}

kanela.modules {

  scala-future {
    name = "Scala Future Intrumentation"
    description = "Provides automatic context propagation to the thread executing a Scala Future's body and callbacks"
    instrumentations = [
      "kamon.instrumentation.futures.scala.FutureChainingInstrumentation"
    ]

    within = [
      "scala.concurrent.*",
      "scala.util.*",
    ]
  }

  executor-service {

    # Since the kamon-executors module has instrumentation for all non-JDK Runnable/Callable implementations we need to
    # explicitly exclude any Scala Future-related Runnables.
    exclude = ${?kanela.modules.executors.exclude} ["scala.concurrent.*"]
  }
}